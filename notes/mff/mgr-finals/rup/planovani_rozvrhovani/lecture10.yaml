deck: All::Magisterské státnice::Řešení úloh a plánování::Plánování a rozvrhování::Přednáška 10
topic: Rozvrhování
notes:
        # planovani lecture01
        -
                uuid: 1cb9a676-012f-4eb4-9271-11fd741dfdad
                front: Čím se zabývá rozvrhování?
                back: Alokací naplánovaných akcí v čase a prostoru
        -
                uuid: df7f4e1b-522b-4c2d-b68b-bec670ae686f
                front: Kdy může být dobré zároveň plánovat a rozvrhovat?
                back: >
                        Když existuje hodně plánů, ale jenom pár z nich má
                        přípustný rozvrh.
        -
                uuid: 320d26c9-1172-4497-b9b5-34bb14d3ffed
                front: Jak se jmenuje notace pro popis rozvrhovacích problémů?
                back: >
                        Grahamova notace
        -
                uuid: 563ea376-f369-4174-b7c5-9cfb6163dbbe
                front: Jak vypadá Grahamova notace; příklady?
                back: >
                        [$$]\\alpha\\mid\\beta\\mid\\gamma[/$$]
                        <br><br>
                        [$]\\alpha[/$]: charakteristika zdrojů.
                        Jednoznačný zdroj; identické/uniformní/různé zdroje;
                        multi-operační model: job-shop/open-shop/flow-shop
                        <br><br>
                        [$]\\beta[/$]: charakteristika úloh.
                        Povolena preempce? Precedenční vztahy?
                        Čas spuštění, uzávěrka, použití dávek?
                        <br><br>
                        [$]\\gamma[/$]: kritérium optimalizace
        -
                uuid: cb4c55c9-8361-4041-8460-7792a6163866
                topic: Notace rozvrhování
                front: Start úlohy
                back: >
                        [$]s(a)[/$]
                include_reverse: true
        -
                uuid: dd82d712-223e-4f5c-8c13-43e2e730665f
                topic: Nomenklatura rozvrhování
                front: Release date
                back: Minimální čas startu
                include_reverse: true
        -
                uuid: fc3a699d-1d66-463e-9629-6ac354d73572
                topic: Notace rozvrhování
                front: Konec úlohy
                back: >
                        [$]e(a)[/$]
                include_reverse: true
        -
                uuid: fcd85efd-a94a-4738-a565-31df70b43929
                topic: Nomenklatura rozvrhování
                front: Deadline
                back: Uzávěrka - kdy musí úloha být hotová
                include_reverse: true
        -
                uuid: a40a3487-eb56-4afc-9477-c9cd670a2f5f
                topic: Nomenklatura rozvrhování
                front: Due date; značení
                back: Termín dokončení [$]\\delta(a)[/$]
                include_reverse: true
        -
                uuid: 81f2766c-8a68-4839-81e4-e41a256fa110
                topic: Notace rozvrhování
                front: Doba trvání úlohy
                back: >
                        [$$]p(a)[/$$]
        -
                uuid: ead342d7-edfe-4d8e-8bbb-2232b9d8f897
                front: Co to znamená, že zdroj je unární (nebo disjunktivní)?
                back: Běží na něm jenom jedna úloha najednou
        -
                uuid: 0da2e2af-15f2-4a80-a99b-a8e590e39491
                front: Co jsou preemptivní a nepreemptivní úlohy?
                back: >
                        Preemptivní úlohu jde přerušit jinou úlohou
        -
                uuid: a50dee94-bc78-4d9d-9c57-797e65e1c53e
                topic: Metriky rozvrhování
                front: Makespan
                back: >
                        Značka [$]C[/$]<br><br>
                        [$$]\\max\\{e(a): a\\in A\\}[/$$]
                include_reverse: true
        -
                uuid: 35e81183-9838-472d-b9f4-e9153951a213
                topic: Metriky rozvrhování
                front: Lateness
                back: >
                        Značka [$]L[/$]<br><br>
                        [$$]e(a)-\\delta(a)[/$$]
                include_reverse: true
        -
                uuid: ad26ebd5-6e85-485c-9eaa-705e416205ef
                topic: Metriky rozvrhování
                front: Earliness
                back: >
                        Značka [$]E[/$]<br><br>
                        [$$]\\max(0,\\delta(a)-e(a))[/$$]
                include_reverse: true
        -
                uuid: f6051b78-7d91-40a2-ba5c-45ae6ddfa811
                topic: Metriky rozvrhování
                front: Tardiness
                back: >
                        Značka [$]\\tau[/$]<br><br>
                        [$$]\\max(0,e(a)-\\delta(a))[/$$]
                include_reverse: true
        -
                uuid: b4b0882b-bcf4-4579-9d38-4a4a4d95304d
                topic: Metriky rozvrhování
                front: Absolutní odchylka
                back: >
                        Značka [$]D[/$]<br><br>
                        [$$]|e(a)-\\delta(a)|[/$$]
                include_reverse: true
        -
                uuid: bdbf837f-1dce-4053-b227-9eea866a2594
                topic: Metriky rozvrhování
                front: Čtvercová odchylka
                back: >
                        Značka [$]S[/$]<br><br>
                        [$$] (e(a)-\\delta(a))^2[/$$]
                include_reverse: true
        -
                uuid: 24723a3a-3e49-4b75-b507-8915876e1014
                topic: Metriky rozvrhování
                front: Zpožděná úloha
                back: >
                        [$$]
                        \\begin{cases}
                        0 & e(a)\\leq\\delta(a) \\\\\\\\
                        1 & \\text{jinak}
                        \\end{cases}
                        [/$$]
                include_reverse: true
        -
                uuid: 066bdaa3-529a-4b06-8d8b-4d016d3aa307
                topic: Metriky rozvrhování
                front: Metriky kolem zdrojů?
                back: >
                        Minimalizace rekonfigurace, počtu strojů,
                        maximálního zatížení
        -
                uuid: 68c778d3-de92-4d2c-89ed-96ca089227a6
                markdown: false
                topic: >
                        [$$]1\mid r_{j}\mid L_{\max}[/$$]
                front: Specifikace
                back: Plánování na jednom zdroji, úlohy mají release date a due date, minimalizuji maximální překročení termínu (lateness)
        -
                uuid: 2c73eb11-b3b1-44d4-86c0-efda3b7c68a6
                topic: >
                        [$$]1\mid r_j\mid L_{\max}[/$$]
                front: Složitost
                back: Obecně NP-hard
        -
                uuid: 7e92448d-8e99-42c0-85b4-0da65c91db5e
                topic: >
                        [$$]1\mid r_j\mid L_{\max}[/$$]
                front: Polynomiálně řešitelné relaxace
                back: >
                        Identický release date / due date / povolená preempce
        -
                uuid: 0b02d88e-dfd7-42b2-8293-a400790d1614
                topic: >
                        [$$]1\mid r_j\mid L_{\max}[/$$]
                front: Jak řešit, když mají všechny úlohy stejný release date?
                back: >
                        Uspořádám podle *earliest due date*.
        -
                uuid: db84d7e2-65f8-44a1-a6b4-708df8424efe
                topic: >
                        [$$]1\mid r_j\mid L_{\max}[/$$]
                front: Jak řešit, když úlohy mají všechny stejný due date?
                back: >
                        Uspořádám v neklesajícím pořadí podle termínu dostupnosti
        -
                uuid: 068ababf-3226-4a3f-9bb8-cd84eca90b04
                topic: >
                        [$$]1\mid r_j\mid L_{\max}[/$$]
                front: Jak řešit, když povolím preempci?
                back: >
                        Optimální rozvrh konstruuj podle pravidla UDD.
                        Jakmile narazím na další termín dostupnosti nebo
                        dokončím úlohu, změním task, na kterém dělám, na úlohu,
                        která má teď nejmenší due date.
        -
                uuid: f7a4aaa9-3cf2-42d5-96b7-0a5847ce371b
                topic: >
                        [$$]1\mid r_j\mid L_{\max}[/$$]
                front: Jak se řeší obecný nerelaxovaný problém?
                back: >
                        Je NP-těžký.
                        <br><br>
                        Větvením vybírám, kterou úlohu budu teď plánovat.
                        Používám branch and bound.
                        <br><br>
                        Potřebuju v každém podstromu znát dolní odhad na řešení.
                        Pokud je tenhle odhad větší než zatím nejlepší známé
                        řešení, nemusím ten strom prohledávat.
                        <br><br>
                        Odhad získáme relaxací s umožněním preempce.
                        <br>
                        Pokud mám nepreemptivní rozvrh stejně dobrý jako
                        preemptivní řešení, nemusím hledat dál (lepší
                        rozvrh neexistuje).
        -
                uuid: ed3545e3-d9f1-42f3-98af-a09e20340245
                front: Typy paralelních zdrojů
                back: >
                        *Identické*: úlohy se zpracovávají stejnou dobu
                        <br><br>
                        *Uniformní*: každý zdroj má koeficient rychlosti
                        oproti normálu
                        <br><br>
                        *Různé*: doba zpracování může být ve zdrojích úplně
                        různá
        -
                uuid: 0f69ddf9-4dd1-4ee8-a25d-f7b8737e6141
                front: Co když mám alternativní zdroje na řešení preemptivní úlohy?
                back: >
                        Úlohu můžu posouvat na různé zdroje, ale nesmí běžet
                        na různých zdrojích najednou.
        -
                uuid: 84479092-9ca9-494e-a04a-435961917e7c
                topic: >
                        [$$]p_m\mid\mathrm{preempt}\mid C_{\max}[/$$]
                front: Zadání?
                back: >
                        Minimalizuji makespan, úlohy jsou preemptivní, mám
                        [$]m[/$] identických alternativních zdrojů
        -
                uuid: 8ec891ec-6424-4856-bcb1-a67d3d4f44b0
                topic: >
                        [$$]p_m\mid\mathrm{preempt}\mid C_{\max}[/$$]
                front: Dolní odhad makespanu
                back: >
                        [$$]LB = \\max\\{ \\max_i p_i, (\\sum_i p_i)/m \\}[/$$]
        -
                uuid: 681b86e1-d6e7-403d-9a7b-998ec3f7cb89
                topic: >
                        [$$]p_m\mid\mathrm{preempt}\mid C_{\max}[/$$]
                front: Jak lze sestavit rozvrh s optimálním makespanem, a jak rychle?
                back: >
                        Jde to za [$]\\O(n)[/$].
                        <br><br>
                        Úlohy řadíme v libovolném pořadí. Jakmile dosáhneme
                        [$]LB[/$], úlohu rozdělíme a pokračujeme v jejím
                        schedulování na dalším stroji. Protože [$]p_i\\leq LB[/$],
                        tak se úlohy nikdy nebudou samy se sebou překrývat.
        -
                uuid: ff5553c5-c506-4b6c-9e1c-751d105384f0
                topic: >
                        [$$]p_m\mid\mathrm{prec}\mid C_{\max}[/$$]
                front: Zadání
                back: >
                        Minimalizace makespanu, úlohy jsou nepreemptivní,
                        máme [$]m[/$] identických alternativních zdrojů,
                        mezi úlohami jsou precedenční vztahy.
        -
                uuid: 71db15a1-e558-4a97-aad3-1efc3fc8742e
                topic: >
                        [$$]p_m\mid\mathrm{prec}\mid C_{\max}[/$$]
                front: Složitost a řešení
                back: >
                        Když [$]n\\leq m[/$], použiju metodu kritické cesty.
                        <br><br>
                        Když [$]2\\leq m<n[/$], je to NP-úplný problém.
        -
                uuid: a6da1795-8604-4be2-879b-6e4d50b874a1
                topic: >
                        [$$]p_m\mid\mathrm{prec}\mid C_{\max}[/$$]
                front: Metoda kritické cesty; které úlohy jsou kritické?
                back: >
                        Dopředná fáze: najdu minimální startovní a koncové časy,
                        začnu od úloh co nemají předchůdce.
                        <br><br>
                        Zpětná fáze najde maximální startovní a koncové časy.
                        Začnu od úloh co nemají následníka.
                        <br><br>
                        Kritické úlohy jsou ty, co mají stejný minimální
                        a maximální čas začátku.
        -
                uuid: 9ccbaa41-9573-4ce3-bc11-36f9609cec82
                front: Co je to multi-operační, resp. shop model?
                back: >
                        Úloha (job) je rozdělená do menších operací.
                        Mezi operacemi můžou být různé precedenční vztahy.
                        Zdroje pro operace jsou jednoznačně určeny.
        -
                uuid: 0385e492-f510-4d32-80ef-bf28de9aedc5
                front: Job-shop model
                back: >
                        Operace v rámci úlohy jsou lineárně uspořádány.<br><br>
                        Různé úlohy můžou mít různé pořadí a počet operací.<br><br>
                        Zpravidla je každý zdroj jednou úlohou navštíven jenom jednou.
        -
                uuid: ed3e4f3c-cf58-4356-93b6-81f9173cbcad
                front: Flow-shop model
                back: >
                        Speciální případ job-shop. Všechny úlohy mají stejný počet
                        a stejné pořadí operací. Příklad: pásová výroba.
        -
                uuid: 04d7ec87-0a91-4779-948d-63803e4951eb
                front: Open-shop model
                back: Jako flow-shop, ale bez uspořádání operací.
        -
                uuid: 4215e636-7594-41ba-b20a-c04e72f10b23
                front: Věta o flow-shop a zdrojích, důkaz
                markdown: false
                back: >
                        Při minimalizaci makespanu u flow-shop problému
                        existuje optimální rozvrh, kde je pořadí úloh na prvních
                        (posledních) dvou zdrojích totožné.
                        <br><br>
                        Ať je [$]k[/$] počet úloh, co mají operace na začátku
                        uspořádané identicky na obou zdrojích.
                        <br>
                        Vezmu optimální rozvrh, co má největší [$]k[/$].
                        Jestli je [$]k[/$] jiné než počet úloh,
                        nastává tohle:<br>
                        <code>
                        ..A..|..C..| ... ... |..D..|..B..|     <br>
                                             |..A..|     |..B..
                        </code>
                        <br>
                        Potom ale můžu přesunout B těsně za A, a to neprodlouží
                        makespan:<br>
                        <code>
                        ..A..|..B..|..C..| ... ... |..D..     <br>
                                             |..A..|..B..
                        </code>
                        <br>
                        Takže jsme dostali jiný rozvrh, co je optimální a má
                        větší [$]k[/$].
        -
                uuid: 2a926e97-7d7f-4de2-8556-c8f06fb57d0d
                topic: >
                        [$$]F2\mid\mid C_{\max}[/$$]
                front: Úloha
                back: >
                        Flow-shop problém na dvou zdrojích s minimalizací makespanu
                        <br><br>
                        Každá úloha se skládá ze dvou operací, každá operace
                        na jednom stroji.
        -
                uuid: 9dc0540b-f373-4e33-a19b-8e586a2e201b
                topic: >
                        [$$]F2\mid\mid C_{\max}[/$$]
                front: Řešení
                back: >
                        Máme dokázáno, že stačí jenom určit pořadí, a na obou
                        strojích může být stejné.
                        <br><br>
                        Úlohy rozdělíme do [$]U[/$]: úlohy co mají operaci
                        na zdroji 1 kratší než na zdroji 2, [$]V[/$]:
                        úlohy co mají operaci na zdroji 1 delší než na zdroji 2.
                        <br><br>
                        Správné pořadí je: [$]U[/$] uspořádané vzestupně
                        podle [$]p_{1j}[/$], pak [$]V[/$] sestupně
                        podle [$]p_{2j}[/$]. Každou operai rozvrhneme
                        do co nejmenšího možného startovního času.
        -
                uuid: cc118a32-453c-4936-960a-b38335bbf6f7
                topic: Job-shop
                front: Čím je job-shop problém specifikován?
                back: >
                        Množinou [$]m[/$] zdrojů, [$]n[/$] úloh,
                        objektivní funkcí.
                        <br><br>
                        Každá úloha je posloupnost operací co jsou různé
                        pro různé úlohy. Zdroj se může při zpracování úlohy
                        navštívit i vícekrát. Zdroj a čas zpracování je
                        pro každou operaci pevný.
        -
                uuid: 2b5ee856-6615-47c3-a164-a43fa751e4d9
                topic: Job-shop
                front: Jak těžké problémy job-shop typu jsou?
                back: >
                        Převážně NP-úplné
        -
                uuid: b71fa382-8d15-4e0d-8e9d-e26343652422
                topic: >
                        [$$]J2\mid n_i\leq 2\mid C_{\max}[/$$]
                front: Úloha
                back: >
                        Job-shop, dva zdroje, maximálně 2 operace na úlohu,
                        minimalizace makespanu.
        -
                uuid: e7e9b5d7-7c4f-449d-9fe1-afad27a2d38c
                topic: >
                        [$$]J2\mid n_i\leq 2\mid C_{\max}[/$$]
                front: Řešení
                back: >
                        Úlohy rozdělíme na 4 množiny:
                        [$]I_1[/$] běží jen na prvním zdroji, [$]I_2[/$]
                        na druhém, [$]I_{1,2}[/$] nejdřív na prvním,
                        [$]I_{2,1}[/$] nejdřív na druhém.
                        <br><br>
                        Najdu optimální posloupnosti úloh [$]R_{1,2}, R_{2,1}[/$]
                        pro flow-shop problémy nad [$]I_{1,2}[/$] a [$]I_{2,1}[/$].
                        <br><br>
                        Finální rozvrh:<br><br>
                        Na [$]M_1[/$] nejdřív úlohy
                        [$]I_{1,2}[/$] podle řešení [$]R_{1,2}[/$], pak
                        [$]I_1[/$] v libovolném pořadí, pak [$]I_{2,1}[/$]
                        podle řešení [$]R_{2,1}[/$].<br><br>
                        Na [$]M_2[/$] nejdřív úlohy
                        [$]I_{2,1}[/$] podle řešení [$]R_{2,1}[/$], pak
                        [$]I_2[/$] v libovolném pořadí, pak [$]I_{1,2}[/$]
                        podle řešení [$]R_{1,2}[/$].<br>
                        <br>
                        Je to optimální rozvrh, protože aspoň jeden ze zdrojů
                        pracuje bez přerušení a [$]R_{1,2}[/$], [$]R_{2,1}[/$]
                        jsou optimální rozvrhy.
        -
                uuid: 4ea5dd08-eeaf-40f1-928a-93d8e4a7594e
                topic: >
                        [$$]Jm \mid \mid C_{\max}[/$$]
                front: Co to je disjunktivní graf?
                back: >
                        Uzly jsou operace, každý uzel má váhu rovnou délce operace.
                        Dodatečně: [$]S[/$], [$]T[/$] s vahou 0
                        <br><br>
                        Orientované hrany. Konjunktivní: precedence mezi operacemi,
                        plus z [$]S[/$] do operací bez předka a z operací bez
                        potomka do [$]T[/$].
                        <br>
                        Disjunktní: spojují operace různých úloh prováděných
                        na stejném zdroji; tvoří kliky.
                        <br><br>
                        Disjunktivním grafem se bude kódovat problém i rozvrh.
        -
                uuid: 52241070-d4e8-4d53-8b65-814d18871451
                topic: >
                        [$$]Jm \mid \mid C_{\max}[/$$]
                front: Jak vyčteme z grafu korektní rozvrh? Kde bude makespan?
                back: >
                        V korektním rozvrhu se z disjunktních hran vybere jedna,
                        aby ve vzniklém grafu nebyly cykly. Makespan potom
                        bude délka nejdelší cesty z [$]S[/$] do [$]T[/$].
        -
                uuid: a6480cf5-d581-42e4-a608-933f3b1927d7
                topic: >
                        [$$]Jm \mid \mid C_{\max}[/$$]
                front: Jak těžký to je problém?
                back: >
                        NP-úplný
        -
                uuid: 9ac47d5d-37f5-438b-af18-6028eb82e8eb
                topic: >
                        [$$]Jm \mid \mid C_{\max}[/$$]
                front: Jak budeme budovat heuristický algoritmus?
                back: >
                        Zafixujeme všechny proměnné a podle zbylé proměnné
                        optimalizujeme, opakujeme na všech proměnných.
                        (Tohle děláme se zdroji: samostatně budeme optimalizovat každý zdroj.)
                        <br><br>
                        Pro zvýšení šancí na nalezení dobrého řešení: bereme
                        proměnné/zdroje podle klesající důležitosti
        -
                uuid: 7cce7305-3364-47d2-8572-5b2f9651257e
                topic: >
                        [$$]Jm \mid \mid C_{\max}[/$$]
                front: Jak budeme rozvrhovat jeden zdroj?
                back: >
                        Začneme s částečným řešením.<br><br>
                        Vyřešíme pro zdroj, který ještě není rozvrženný,
                        problém [$]1\\mid r_j\\mid L_{\\max}[/$], kde trvání
                        operací [$]p_i[/$] je dané původním problémem,
                        [$]r_i[/$] je délka nejdelší cesty ze startu do úlohy,
                        termín dokončení je [$]\\delta_i = \\text{nejdelsi cesta}(S,T)
                        -\\text{nejdelsi cesta}(i,T)+p_i[/$].
                        <br><br>
                        Zdroj, který dá největší zpoždění [$]L_{\\max}[/$],
                        nazvu úzkým hrdlem (bottleneck) a jeho rozvrh přidám
                        do řešení.
        -
                uuid: b9d3974b-7397-4b44-9312-0b3b419405d3
                topic: >
                        [$$]Jm \mid \mid C_{\max}[/$$]
                front: Jak můžeme zlepšit hotové řešení?
                back: >
                        Podívám se na zdroj, jeho hrany vytrhám z grafu
                        a znova vyřeším jeho problém [$]1\\mid r_j\\mid L_{\\max}[/$].
        -
                uuid: c82e804d-2e2f-43b2-ae13-3db2586cf142
                topic: >
                        [$$]Jm \mid \mid C_{\max}[/$$]
                front: Jak se heuristický algoritmus jmenuje?
                back: Shifting Bottleneck
