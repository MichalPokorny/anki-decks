deck: All::Magisterské státnice::Řešení úloh a plánování::Plánování a rozvrhování::Přednáška
        10
topic: Rozvrhování
notes:
        # planovani lecture01
        -       guid: xI~pe<o?z>
                front: Čím se zabývá rozvrhování?
                back: Alokací naplánovaných akcí v čase a prostoru
        -       guid: DwG2>z=Qi.
                front: Kdy může být dobré zároveň plánovat a rozvrhovat?
                back: |
                        Když existuje hodně plánů a jenom pár má
                        přípustný rozvrh.
        -       guid: vCb9jdsD*J
                front: |
                        Název: Notace pro popis rozvrhovacích problémů
                back: |
                        Grahamova notace
        -       guid: ci#gO@Ni{t
                front: Jak vypadá Grahamova notace
                back: |
                        [$]\\alpha\\mid\\beta\\mid\\gamma[/$]
                        <br><br>
                        [$]\\alpha[/$]: zdroje,
                        [$]\\beta[/$]: úlohy,
                        [$]\\gamma[/$]: kritérium optimalizace
        -       guid: c~6<A@Y)s{
                front: Grahamova notace - příklady zdrojů ([$]\\alpha[/$])
                back: |
                        Jednoznačný zdroj; identické/uniformní/různé zdroje;
                        multi-operační model: job-shop/open-shop/flow-shop
        -       guid: o$1Po3|Q3*
                front: Grahamova notace - příklady úloh ([$]\\beta[/$])
                back: |
                        Preempce? Precedenční vztahy?
                        Čas spuštění, uzávěrka, použití dávek?
        -       guid: GKQ>MiW:TT
                topic: Notace rozvrhování
                front: Start úlohy
                back: |
                        [$]s(a)[/$]
                include_reverse: true
        -       guid: n}M{[W(>Fa
                topic: Nomenklatura rozvrhování
                front: Release date
                back: Minimální čas startu
                include_reverse: true
        -       guid: xhK]Dowf?h
                topic: Notace rozvrhování
                front: Konec úlohy
                back: |
                        [$]e(a)[/$]
                include_reverse: true
        -       guid: Fo-Q*CB$1}
                topic: Nomenklatura rozvrhování
                front: Deadline
                back: Uzávěrka - kdy musí úloha být hotová
                include_reverse: true
        -       guid: kuji:Q.[Cc
                topic: Nomenklatura rozvrhování
                front: Due date; značení
                back: Termín dokončení [$]\\delta(a)[/$]
                include_reverse: true
        -       guid: lnyOxY:Z>6
                topic: Notace rozvrhování
                front: Doba trvání úlohy
                back: |
                        [$]p(a)[/$]
        -       guid: wS/&_;wf$i
                front: |
                        Co to znamená, že zdroj je unární/disjunktivní?
                back: Zpracovává jednu úlohu najednou
        -       guid: QVUiJrCXOM
                front: Co jsou preemptivní a nepreemptivní úlohy?
                back: |
                        Preemptivní úlohu jde přerušit jinou úlohou
        -       guid: M,`?Ih2[x#
                topic: Metriky rozvrhování
                front: Makespan
                back: |
                        Značka [$]C[/$]<br><br>
                        [$]\\max\\{e(a): a\\in A\\}[/$]
                include_reverse: true
        -       guid: Ir`PR0Xr[o
                topic: Metriky rozvrhování
                front: Lateness
                back: |
                        Značka [$]L[/$]<br><br>
                        [$]e(a)-\\delta(a)[/$]
                include_reverse: true
        -       guid: J~hTfYxwy+
                topic: Metriky rozvrhování
                front: Earliness
                back: |
                        Značka [$]E[/$]<br><br>
                        [$]\\max(0,\\delta(a)-e(a))[/$]
                include_reverse: true
        -       guid: PL.V^RPR_<
                topic: Metriky rozvrhování
                front: Tardiness
                back: |
                        Značka [$]\\tau[/$]<br><br>
                        [$]\\max(0,e(a)-\\delta(a))[/$]
                include_reverse: true
        -       guid: zt,5tSd#]H
                topic: Metriky rozvrhování
                front: Absolutní odchylka
                back: |
                        Značka [$]D[/$]<br><br>
                        [$]|e(a)-\\delta(a)|[/$]
                include_reverse: true
        -       guid: tL/]3,L(qL
                topic: Metriky rozvrhování
                front: Čtvercová odchylka
                back: |
                        Značka [$]S[/$]<br><br>
                        [$] (e(a)-\\delta(a))^2[/$]
                include_reverse: true
        -       guid: HSQOd[{+vL
                topic: Metriky rozvrhování
                front: Zpožděná úloha
                back: |
                        [$$]
                        \\begin{cases}
                        0 & e(a)\\leq\\delta(a) \\\\\\\\
                        1 & \\text{jinak}
                        \\end{cases}
                        [/$$]
                include_reverse: true
        -       guid: P7CvU,y={$
                topic: Metriky rozvrhování
                front: Metriky kolem zdrojů?
                back: |
                        Minimalizace rekonfigurace, počtu strojů,
                        maximálního zatížení
        -       guid: w7>s[M+,cP
                markdown: false
                topic: "[$]1\\mid r_{j}\\mid L_{\\max}[/$]\n"
                front: Specifikace
                back: Plánování na jednom zdroji, úlohy mají release date a due date,
                        minimalizuji maximální překročení termínu (lateness)
        -       guid: y?5j^6mhct
                topic: "[$]1\\mid r_j\\mid L_{\\max}[/$]\n"
                front: Složitost
                back: Obecně NP-hard
        -       guid: IEWxH8>Y(&
                topic: "[$]1\\mid r_j\\mid L_{\\max}[/$]\n"
                front: Polynomiálně řešitelné relaxace
                back: |
                        Identický release date/due date; povolená preempce
        -       guid: ArpE](vIbP
                topic: "[$]1\\mid r_j\\mid L_{\\max}[/$]\n"
                front: Jak řešit, když mají všechny úlohy stejný release date?
                back: |
                        Uspořádám podle *earliest due date*.
        -       guid: ym#e^1Twyz
                topic: "[$]1\\mid r_j\\mid L_{\\max}[/$]\n"
                front: Jak řešit, když úlohy mají všechny stejný due date?
                back: |
                        Uspořádám v neklesajícím pořadí podle
                        termínu dostupnosti
        -       guid: FQD3,?+`|v
                topic: "[$]1\\mid r_j\\mid L_{\\max}[/$]\n"
                front: Jak řešit, když povolím preempci?
                back: |
                        EDD.
                        <br>
                        Narazím na další termín dostupnosti nebo
                        dokončím úlohu &rarr; přepni na úlohu,
                        co má teď nejmenší due date.
        -       guid: vC>g7Y!;nx
                topic: |
                        [$]1\\mid r_j\\mid L_{\\max}[/$]
                front: Složitost obecného nerelaxovaného problému
                back: |
                        NP-těžký
        -       guid: h8:cnZEU<[
                markdown: false
                topic: |
                        [$]1\mid r_j\mid L_{\max}[/$]
                front: Řešení obecného nerelaxovaného problému
                back: |
                        Větvi na úloze, kterou teď plánuješ. Použij branch and
                        bound.
                        <br><br>
                        V podstromu spočítej dolní odhad na řešení - relaxací
                        s preempcí. Větší než zatím nejlepší známé řešení?
                        Zařízni prohledávání.
                        <br>
                        Když najdu nepreemptivní rozvrh stejně dobrý jako
                        preemptivní řešení, nehledám dál (lepší rozvrh není).
        -       guid: zc7x^3}szw
                front: Typy paralelních zdrojů podle doby zpracování úloh
                back: |
                        <ul>
                        <li> <i>Identické</i>: stejná trvání úloh
                        <li> <i>Uniformní</i>: koeficienty rychlosti oproti
                        normálu
                        <li> <i>Různé</i>: doba zpracování na zdrojích úplně
                        různá
                        </li>
        -       guid: gw^{%2oU6H
                front: Co když mám alternativní zdroje na řešení preemptivní úlohy?
                back: |
                        Úlohu můžu posouvat na různé zdroje, ale nesmí běžet
                        na různých zdrojích najednou.
        -       guid: s|#K[j832.
                topic: "[$$]p_m\\mid\\mathrm{preempt}\\mid C_{\\max}[/$$]\n"
                front: Zadání?
                back: |
                        Minimalizuji makespan, úlohy jsou preemptivní, mám
                        [$]m[/$] identických alternativních zdrojů
        -       guid: kwH@1%B*wR
                topic: "[$$]p_m\\mid\\mathrm{preempt}\\mid C_{\\max}[/$$]\n"
                front: Dolní odhad makespanu
                back: |
                        [$$]LB = \\max\\{ \\max_i p_i, (\\sum_i p_i)/m \\}[/$$]
        -       guid: vjVYJ^yTGD
                topic: "[$$]p_m\\mid\\mathrm{preempt}\\mid C_{\\max}[/$$]\n"
                front: Jak lze sestavit rozvrh s optimálním makespanem, a jak rychle?
                back: |
                        Čas [$]\\O(n)[/$].
                        <br><br>
                        Úlohy řaď libovolně. Dosáhneš [$]LB[/$] &rarr; úlohu
                        rozděl, dokonči běh na dalším stroji. Protože
                        [$]p_i\\leq LB[/$], úlohy nebudou samy sebe překrývat.
        -       guid: bp:hUhS_vD
                topic: "[$$]p_m\\mid\\mathrm{prec}\\mid C_{\\max}[/$$]\n"
                front: Zadání
                back: |
                        Minimalizace makespanu, úlohy jsou nepreemptivní,
                        máme [$]m[/$] identických alternativních zdrojů,
                        mezi úlohami jsou precedenční vztahy.
        -       guid: iW6h@Hvqh]
                topic: "[$$]p_m\\mid\\mathrm{prec}\\mid C_{\\max}[/$$]\n"
                front: Složitost a řešení
                back: |
                        Když [$]n\\leq m[/$], použiju metodu kritické cesty.
                        <br><br>
                        Když [$]2\\leq m<n[/$], je to NP-úplný problém.
        -       guid: C}EhP}3i_j
                topic: "[$$]p_m\\mid\\mathrm{prec}\\mid C_{\\max}[/$$]\n"
                front: Metoda kritické cesty; které úlohy jsou kritické?
                back: |
                        Dopředná fáze: najdu minimální startovní a koncové časy,
                        začnu od úloh co nemají předchůdce.
                        <br><br>
                        Zpětná fáze najde maximální startovní a koncové časy.
                        Začnu od úloh co nemají následníka.
                        <br><br>
                        Kritické úlohy jsou ty, co mají stejný minimální
                        a maximální čas začátku.
        -       guid: zauJ=*},_O
                front: Co je to multi-operační, resp. shop model?
                back: |
                        Úloha (job) je rozdělená do menších operací.
                        Mezi operacemi můžou být různé precedenční vztahy.
                        Zdroje pro operace jsou jednoznačně určeny.
        -       guid: sfeLPYxy>J
                front: Job-shop model
                back: |
                        Operace v rámci úlohy jsou lineárně uspořádány.<br><br>
                        Různé úlohy můžou mít různé pořadí a počet operací.<br><br>
                        Zpravidla je každý zdroj jednou úlohou navštíven jenom jednou.
        -       guid: AIX`v@>HXv
                front: Flow-shop model
                back: |
                        Speciální případ job-shop. Všechny úlohy mají stejný
                        počet a pořadí operací. Příklad: pásová výroba.
        -       guid: ns-t%STobs
                front: Open-shop model
                back: Flow-shop bez uspořádání operací.
        -       guid: n8J<XNx(#O
                front: Věta o flow-shop a zdrojích, důkaz
                markdown: false
                back: |
                        Při [$]\\min C_{\\max}[/$] u flow-shop problému
                        existuje optimální rozvrh, kde je pořadí úloh na
                        prvních dvou zdrojích totožné.
                        <br><br>
                        [$]k\\leftarrow[/$] počet úloh, co mají operace na
                        začátku uspořádané identicky na obou zdrojích.
                        <br>
                        Vezmu optimální rozvrh, co má největší [$]k[/$].
                        Jestli [$]k\\neq n[/$], tak:
                        <br>
                        <code>
                        ..A..|..C..| ... ... |..D..|..B..|     <br>
                                             |..A..|     |..B..
                        </code>
                        <br>
                        Potom můžu přesunout B těsně za A, to neprodlouží
                        makespan:<br>
                        <code>
                        ..A..|..B..|..C..| ... ... |..D..     <br>
                                             |..A..|..B..
                        </code>
                        <br>
                        Dostali jsme jiný rozvrh, co je optimální a má
                        větší [$]k[/$].
        -       guid: yhe^#?>ceJ
                topic: "[$]F2\\mid\\mid C_{\\max}[/$]\n"
                front: Úloha
                back: |
                        Flow-shop problém, 2 zdroje, minimalize makespanu
                        <br><br>
                        Úloha má 2 operace, každou na jednom stroji.
        -       guid: p%)/.<KTR)
                topic: "[$]F2\\mid\\mid C_{\\max}[/$]\n"
                front: Řešení
                back: |
                        Stačí najít pořadí, na obou strojích může být stejné.
                        <br><br>
                        Úlohy rozděl:
                        <ul>
                        <li> [$]U[/$]: na [$]z_1[/$] kratší než na [$]z_2[/$]
                        <li> [$]V[/$]: na [$]z_1[/$] delší než na [$]z_2[/$]
                        </ul>
                        <br>
                        Správné pořadí:
                        <ol type="1">
                        <li> [$]U[/$] vzestupně dle [$]p_{1j}[/$]
                        <li> [$]V[/$] sestupně dle [$]p_{2j}[/$]
                        </ul>
                        <br>
                        Operace rozvrhni do nejmenšího možného startovního
                        času.
        -       guid: FlNkhXS+d.
                topic: Job-shop
                front: Čím je job-shop problém specifikován?
                back: |
                        Množinou [$]m[/$] zdrojů, [$]n[/$] úloh,
                        objektivní funkcí.
                        <br><br>
                        Každá úloha: posloupnost operací, různé
                        mezi úlohami. Zdroj může navštívit vícekrát.
                        Zdroj a čas zpracování je pro každou operaci pevný.
        -       guid: 'gKf^fYK1[:'
                topic: Job-shop
                front: Jak těžké problémy job-shop typu jsou?
                back: |
                        Převážně NP-úplné
        -       guid: PRz#nx1|;1
                topic: "[$]J2\\mid n_i\\leq 2\\mid C_{\\max}[/$]\n"
                front: Úloha
                back: |
                        Job-shop, 2 zdroje, maximálně 2 operace na úlohu,
                        minimalizace makespanu.
        -       guid: K<Ujj*M4]q
                topic: "[$]J2\\mid n_i\\leq 2\\mid C_{\\max}[/$]\n"
                front: Řešení
                back: |
                        Úlohy rozdělíme:
                        <ul>
                        <li> [$]I_1[/$] jen na [$]z_1[/$]
                        <li> [$]I_2[/$] jen na [$]z_2[/$]
                        <li> [$]I_{1,2}[/$] nejdřív na [$]z_1[/$]
                        <li> [$]I_{2,1}[/$] nejdřív na [$]z_2[/$]
                        </ul>
                        <br>
                        Najdi optimální řešení [$]R_{1,2}, R_{2,1}[/$]
                        pro flow-shop problémy [$]I_{1,2}, I_{2,1}[/$].
                        <br><br>
                        Finální rozvrh:<br><br>
                        Na [$]z_1[/$]:
                        <ol type="1">
                        <li> [$]I_{1,2}[/$] podle [$]R_{1,2}[/$]
                        <li> [$]I_1[/$] v libovolném pořadí
                        <li> [$]I_{2,1}[/$] podle [$]R_{2,1}[/$]
                        </ol>
                        Na [$]z_2[/$]:
                        <ol type="2">
                        <li> [$]I_{2,1}[/$] podle [$]R_{2,1}[/$]
                        <li> [$]I_2[/$] v libovolném pořadí
                        <li> [$]I_{1,2}[/$] podle [$]R_{1,2}[/$]
                        </ol>
                        Je to optimální rozvrh: aspoň 1 ze zdrojů
                        pracuje bez přerušení, [$]R_{1,2}, R_{2,1}[/$]
                        jsou optimální rozvrhy.
        -       guid: Bm8/:vN)rH
                topic: "[$]Jm \\mid \\mid C_{\\max}[/$]\n"
                front: Co je disjunktivní graf?
                back: |
                        Uzly: operace, každý má váhu rovnou délce.
                        Přidej: [$]S[/$], [$]T[/$] s vahou 0
                        <br><br>
                        Orientované hrany. Konjunktivní: precedence operací,
                        z [$]S[/$] do operací bez předka, z operací bez
                        potomka do [$]T[/$].
                        <br>
                        Disjunktní: spojují operace různých úloh na stejném
                        zdroji; tvoří kliky.
                        <br><br>
                        Disjunktivním grafem kódujeme problém i rozvrh.
        -       guid: C:k%*d72Z%
                topic: "[$]Jm \\mid \\mid C_{\\max}[/$]\n"
                front: Jak vyčteme z grafu korektní rozvrh? Kde je makespan?
                back: |
                        Korektní rozvrh: z disjunktních hran vyber jednu, aby
                        v grafu nebyly cykly.
                        <br>
                        Makespan: nejdelší cesta [$]S\\rightarrow T[/$].
        -       guid: rr+LOZAV2S
                topic: "[$]Jm \\mid \\mid C_{\\max}[/$]\n"
                front: Složitost
                back: |
                        NP-úplný
        -       guid: O+4vzxt0OR
                topic: "[$]Jm \\mid \\mid C_{\\max}[/$]\n"
                front: Jak budeme budovat heuristický algoritmus?
                back: |
                        Zafixujeme všechny proměnné a podle jedné proměnné
                        optimalizujeme, opakujeme na všech.
                        (Tohle se zdroji: samostatně optimalizuj každý zdroj.)
                        <br><br>
                        Pro zvýšení šancí na dobré řešení:
                        proměnné/zdroje podle klesající důležitosti
        -       guid: iY2p=]&SX=
                topic: "[$]Jm \\mid \\mid C_{\\max}[/$]\n"
                front: Rozvrhnutí jednoho zdroje
                back: |
                        Začneme s částečným řešením.<br><br>
                        Vyřešíme pro něj [$]1\\mid r_j\\mid L_{\\max}[/$].
                        <br>
                        [$]p_i[/$] z původního problému,
                        [$]r_i\\equiv\\text{nejdelsi cesta(S\\rightarrow i)[/$],
                        [$]\\delta_i = \\text{nejdelsi cesta}(S\\rightarrow T)
                        -\\text{nejdelsi cesta}(i\\rightarrow T)+p_i[/$].
                        <br><br>
                        Zdroj, co dá největší zpoždění [$]L_{\\max}[/$],
                        je bottleneck a jeho rozvrh přidám do řešení.
        -       guid: MBb}aI7e[=
                topic: "[$]Jm \\mid \\mid C_{\\max}[/$]\n"
                front: Zlepšení hotového řešení
                back: |
                        Vezmi zdroj, vytrhej jeho hrany z grafu,
                        znova vyřeš jeho [$]1\\mid r_j\\mid L_{\\max}[/$]
        -       guid: HI[Lv}=]Ts
                topic: "[$]Jm \\mid \\mid C_{\\max}[/$]\n"
                front: |
                        Název: Heuristický algoritmus
                back: Shifting Bottleneck
